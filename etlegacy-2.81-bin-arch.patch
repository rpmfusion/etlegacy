From ccba3baa4caaa6841aea26e9475489dce28fdfa8 Mon Sep 17 00:00:00 2001
From: Petr Mensik <pemensik@redhat.com>
Date: Mon, 6 Mar 2023 19:39:57 +0100
Subject: [PATCH] Do not build client or server with arch suffix by default

---
 cmake/ETLBuildClient.cmake   | 2 --
 cmake/ETLBuildServer.cmake   | 2 --
 cmake/ETLInstall.cmake       | 6 +-----
 misc/etlegacy-x86_64.service | 2 +-
 4 files changed, 2 insertions(+), 10 deletions(-)

diff --git a/cmake/ETLBuildClient.cmake b/cmake/ETLBuildClient.cmake
index e6dd47d..cde4378 100644
--- a/cmake/ETLBuildClient.cmake
+++ b/cmake/ETLBuildClient.cmake
@@ -61,8 +61,6 @@ set_target_properties(etl PROPERTIES
 if(UNIX AND NOT ARM AND NOT APPLE AND NOT ANDROID)
 	if (CROSS_COMPILE32)
 		set_target_properties(etl PROPERTIES SUFFIX ".x86")
-	else()
-		set_target_properties(etl PROPERTIES SUFFIX ".${ARCH}")
 	endif()
 endif()
 
diff --git a/cmake/ETLBuildServer.cmake b/cmake/ETLBuildServer.cmake
index ad0a1aa..375527b 100644
--- a/cmake/ETLBuildServer.cmake
+++ b/cmake/ETLBuildServer.cmake
@@ -19,8 +19,6 @@ set_target_properties(etlded
 if(UNIX AND NOT ARM AND NOT APPLE AND NOT ANDROID)
 	if (CROSS_COMPILE32)
 		set_target_properties(etlded PROPERTIES SUFFIX ".x86")
-	else()
-		set_target_properties(etlded PROPERTIES SUFFIX ".${ARCH}")
 	endif()
 endif()
 
diff --git a/cmake/ETLInstall.cmake b/cmake/ETLInstall.cmake
index 4af4072..c3471ca 100644
--- a/cmake/ETLInstall.cmake
+++ b/cmake/ETLInstall.cmake
@@ -49,12 +49,8 @@ if(UNIX AND NOT APPLE)
 		install(FILES "${CMAKE_CURRENT_SOURCE_DIR}/misc/com.etlegacy.ETLegacy.x86.desktop"
 			DESTINATION "${INSTALL_DEFAULT_SHAREDIR}/applications"
 		)
-	elseif(ARM)
-		install(FILES "${CMAKE_CURRENT_SOURCE_DIR}/misc/com.etlegacy.ETLegacy.aarch64.desktop"
-			DESTINATION "${INSTALL_DEFAULT_SHAREDIR}/application"
-		)
 	else()
-		install(FILES "${CMAKE_CURRENT_SOURCE_DIR}/misc/com.etlegacy.ETLegacy.x86_64.desktop"
+		install(FILES "${CMAKE_CURRENT_SOURCE_DIR}/misc/com.etlegacy.ETLegacy.desktop"
 			DESTINATION "${INSTALL_DEFAULT_SHAREDIR}/applications"
 			)
 	endif()
diff --git a/misc/etlegacy-x86_64.service b/misc/etlegacy-x86_64.service
index fba82df..f8a06a9 100644
--- a/misc/etlegacy-x86_64.service
+++ b/misc/etlegacy-x86_64.service
@@ -6,7 +6,7 @@ After=network.target
 EnvironmentFile=/etc/xdg/etlegacy/etlegacy.conf
 User=etlegacy
 Group=etlegacy
-ExecStart=/usr/bin/etlded.x86_64 +set fs_basepath $FS_BASEPATH + set fs_homepath $FS_HOMEPATH + set fs_game $FS_GAME +exec $EXEC
+ExecStart=/usr/bin/etlded +set fs_basepath $FS_BASEPATH + set fs_homepath $FS_HOMEPATH + set fs_game $FS_GAME +exec $EXEC
 
 [Install]
 WantedBy=multi-user.target
-- 
2.39.2

